<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Epic Piping: Annual Leave Plan 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0b0f1a; color: #e2e8f0; font-family: 'Inter', sans-serif; }
        .gantt-container { display: grid; grid-template-columns: 280px 1fr; }
        .week-segment { flex: 1; border-right: 1px solid #1e293b; font-size: 8px; text-align: center; padding-top: 4px; color: #475569; }
        .week-segment:last-child { border-right: none; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        .leave-bar:hover .tooltip { display: block; }
    </style>
</head>
<body class="p-4 md:p-6">

    <div class="max-w-[1650px] mx-auto">
        <header class="flex flex-col xl:flex-row justify-between items-start xl:items-center mb-6 gap-4">
            <div>
                <h1 class="text-2xl font-bold text-emerald-400 tracking-tight">ANNUAL LEAVE PLAN - 2026</h1>
                <p class="text-slate-500 text-sm">Designation & Team Conflict Tracking Enabled</p>
            </div>

            <div class="flex flex-wrap gap-3 bg-slate-900/80 p-3 rounded-xl border border-slate-800">
                <input type="text" id="nameSearch" placeholder="Search employee..." oninput="renderDashboard()" 
                       class="bg-slate-800 border border-slate-700 rounded px-3 py-1.5 text-sm outline-none focus:border-emerald-500 w-48">
                
                <select id="teamFilter" onchange="renderDashboard()" class="bg-slate-800 border border-slate-700 rounded px-3 py-1.5 text-sm outline-none">
                    <option value="All">All Teams</option>
                    <option value="Team B">Team B</option>
                    <option value="Team C">Team C</option>
                    <option value="Support Team">Support Team</option>
                    <option value="DC Team">DC Team</option>
                    <option value="Material Team">Material Team</option>
                    <option value="CAD Admin Team">CAD Admin Team</option>
                    <option value="Revision Team">Revision Team</option>
                </select>

                <div class="flex items-center gap-3 ml-4 text-[10px] font-bold uppercase tracking-widest text-slate-500 border-l border-slate-700 pl-4">
                    <span class="flex items-center gap-1"><span class="w-3 h-3 bg-emerald-500 rounded"></span> Normal</span>
                    <span class="flex items-center gap-1"><span class="w-3 h-3 bg-red-600 rounded"></span> Conflict</span>
                </div>
            </div>
        </header>

        <div id="conflictPanel" class="hidden mb-6 bg-red-950/20 border border-red-900/40 rounded-xl p-4">
            <h2 class="text-red-500 font-bold text-xs uppercase tracking-widest mb-3 flex items-center gap-2">
                ⚠️ Resource Conflicts Detected (Same Team & Designation)
            </h2>
            <div id="conflictList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2">
                </div>
        </div>

        <div class="bg-slate-900 border border-slate-800 rounded-xl overflow-hidden shadow-2xl">
            <div class="gantt-container bg-slate-800/40 border-b border-slate-700">
                <div class="p-4 font-bold text-slate-400 border-r border-slate-700 uppercase text-[10px] tracking-widest flex items-end">Employee Schedule</div>
                <div class="flex flex-col">
                    <div class="flex border-b border-slate-700/50">
                        <script>
                            const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
                            months.forEach(m => document.write(`<div class="flex-1 text-center py-2 text-[10px] font-bold uppercase border-r border-slate-700/50 text-slate-400">${m}</div>`));
                        </script>
                    </div>
                    <div class="flex">
                        <script>
                            for(let i=0; i<12; i++) {
                                document.write('<div class="flex-1 flex border-r border-slate-700/30">');
                                for(let j=1; j<=4; j++) document.write(`<div class="week-segment">W${j}</div>`);
                                document.write('</div>');
                            }
                        </script>
                    </div>
                </div>
            </div>

            <div id="chartBody" class="max-h-[65vh] overflow-y-auto">
                </div>
        </div>
    </div>

    <script>
        // COMPREHENSIVE DATASET FROM SOURCE 
        const leaveData = [
            { name: "Saurav cs", team: "Team C", role: "Piping Checker", start: "2026-04-15", end: "2026-05-15", remark: "MARRAIGE" },
            { name: "Vivek Krishnan", team: "Team B", role: "Piping Checker", start: "2026-05-24", end: "2026-06-24", remark: "" },
            { name: "Harikrishnan TS", team: "Team B", role: "Piping Checker", start: "2026-08-10", end: "2026-09-10", remark: "" },
            { name: "Mojahid Raja", team: "Team B", role: "Piping Checker", start: "2026-03-23", end: "2026-04-19", remark: "ANNUAL LEAVE" },
            { name: "Shibnath Ghanta", team: "Team B", role: "Team Leader", start: "2026-03-23", end: "2026-04-21", remark: "Anual Leave" },
            { name: "Prosenjit Ghosh", team: "Team B", role: "Piping Checker", start: "2026-10-11", end: "2026-11-20", remark: "" },
            { name: "Rutika Pat", team: "Team B", role: "Piping Detailer", start: "2026-08-16", end: "2026-09-14", remark: "" },
            { name: "Monisha Unnithan", team: "Team C", role: "Piping Checker", start: "2026-09-15", end: "2026-10-14", remark: "" },
            { name: "Sreesh Sureshkumar", team: "Team B", role: "Piping Checker", start: "2026-03-26", end: "2026-05-04", remark: "WEDDING" },
            { name: "Ritesh Kumar", team: "Team B", role: "Piping Checker", start: "2026-04-05", end: "2026-05-01", remark: "" },
            { name: "Sreejin Ms", team: "Team B", role: "Piping Detailer", start: "2026-04-10", end: "2026-05-10", remark: "" },
            { name: "Nikhil Sankar", team: "Team B", role: "Piping Detailer", start: "2026-11-01", end: "2026-12-06", remark: "" },
            { name: "Chetan Yerne", team: "Team C", role: "Team Leader", start: "2026-11-15", end: "2026-12-14", remark: "" },
            { name: "Athul Vincent", team: "Support Team", role: "Support Checker", start: "2026-10-01", end: "2026-10-28", remark: "" },
            { name: "Prakyath Prakash Kumar", team: "DC Team", role: "Document Controller", start: "2026-09-01", end: "2026-10-01", remark: "" },
            { name: "Melisha Dsouza", team: "DC Team", role: "Document Controller", start: "2026-05-03", end: "2026-05-29", remark: "" },
            { name: "Zaheer Ahmed", team: "Team C", role: "Piping Checker", start: "2026-05-07", end: "2026-06-05", remark: "Marriage" },
            { name: "Sruthy Raj", team: "DC Team", role: "Document Controller", start: "2026-11-01", end: "2026-11-30", remark: "" },
            { name: "Suman Mondal", team: "Revision Team", role: "Piping Checker", start: "2026-02-01", end: "2026-03-02", remark: "" },
            { name: "Nishanth IV", team: "Team B", role: "Piping Checker", start: "2026-04-22", end: "2026-05-29", remark: "" },
            { name: "Mohammad Navaz", team: "Team C", role: "Piping Detailer", start: "2026-07-26", end: "2026-08-28", remark: "" },
            { name: "Sabeel Manaf", team: "Team C", role: "Piping Checker", start: "2026-10-04", end: "2026-11-03", remark: "" },
            { name: "Owaish Shamsi", team: "Team B", role: "Piping Checker", start: "2026-10-05", end: "2026-11-05", remark: "" },
            { name: "Rajnish Choubey", team: "Team C", role: "Piping Checker", start: "2026-10-16", end: "2026-11-18", remark: "" },
            { name: "Mohammed Sadhik", team: "Team C", role: "Piping Checker", start: "2026-10-04", end: "2026-11-02", remark: "" },
            { name: "Sayan Mishra", team: "Team C", role: "Piping Detailer", start: "2026-11-01", end: "2026-11-29", remark: "" },
            { name: "Maqbool Ahmad", team: "Team C", role: "Piping Detailer", start: "2026-10-04", end: "2026-10-30", remark: "" },
            { name: "Mohammad Waquar", team: "Team B", role: "Piping Checker", start: "2026-10-15", end: "2026-11-15", remark: "" },
            { name: "Salim Malick", team: "Team C", role: "Piping Detailer", start: "2026-04-12", end: "2026-05-25", remark: "Marriage" },
            { name: "Jayesh Saroj", team: "Support Team", role: "Team Leader", start: "2026-02-09", end: "2026-03-10", remark: "" },
            { name: "Arunkumar Nedunchezhian", team: "Team C", role: "Piping Detailer", start: "2026-07-13", end: "2026-08-13", remark: "" },
            { name: "Krishnakumar Pandiyan", team: "Team C", role: "Piping Detailer", start: "2026-07-12", end: "2026-08-10", remark: "" },
            { name: "Vishnu TRK", team: "Team C", role: "Piping Checker", start: "2026-10-01", end: "2026-10-31", remark: "" }
        ];

        // CONFLICT LOGIC: Same Team + Same Designation + Overlapping Dates 
        function getOverlaps(current, all) {
            return all.filter(other => {
                if (current.name === other.name) return false;
                if (current.team !== other.team || current.role !== other.role) return false;
                
                const s1 = new Date(current.start);
                const e1 = new Date(current.end);
                const s2 = new Date(other.start);
                const e2 = new Date(other.end);
                return s1 <= e2 && s2 <= e1;
            });
        }

        function renderDashboard() {
            const teamFilter = document.getElementById('teamFilter').value;
            const search = document.getElementById('nameSearch').value.toLowerCase();
            const body = document.getElementById('chartBody');
            const confPanel = document.getElementById('conflictPanel');
            const confList = document.getElementById('conflictList');
            
            body.innerHTML = '';
            confList.innerHTML = '';
            let globalConflicts = false;

            leaveData.forEach(emp => {
                const conflicts = getOverlaps(emp, leaveData);
                const isConflicted = conflicts.length > 0;

                // Add to Separate Conflict View
                if (isConflicted) {
                    globalConflicts = true;
                    const cCard = document.createElement('div');
                    cCard.className = "bg-red-950/40 border border-red-800/40 p-2 rounded text-[10px] flex justify-between";
                    cCard.innerHTML = `<span><strong>${emp.name}</strong> ↔ ${conflicts.map(c => c.name).join(', ')}</span><span class="text-slate-500">${emp.team}</span>`;
                    if (!confList.innerHTML.includes(emp.name)) confList.appendChild(cCard);
                }

                // Filter Logic
                if ((teamFilter === 'All' || emp.team === teamFilter) && emp.name.toLowerCase().includes(search)) {
                    const start = new Date(emp.start);
                    const end = new Date(emp.end);
                    const yearStart = new Date('2026-01-01');
                    const dayOfYear = (start - yearStart) / (1000 * 60 * 60 * 24);
                    const duration = (end - start) / (1000 * 60 * 60 * 24);

                    const leftPos = (dayOfYear / 365) * 100;
                    const widthPos = (duration / 365) * 100;

                    const row = document.createElement('div');
                    row.className = 'gantt-container border-b border-slate-800/40 hover:bg-slate-800/20 transition-all';
                    row.innerHTML = `
                        <div class="p-3 border-r border-slate-800 bg-slate-900/50">
                            <div class="text-[11px] font-bold ${isConflicted ? 'text-red-500' : 'text-slate-200'} uppercase">${emp.name}</div>
                            <div class="text-[8px] text-slate-500 font-medium uppercase tracking-tighter">${emp.role} • ${emp.team}</div>
                        </div>
                        <div class="relative h-12 w-full flex items-center px-1">
                            <div class="absolute inset-0 flex pointer-events-none opacity-20">
                                ${Array(12).fill(0).map(() => `<div class="flex-1 border-r border-slate-700"></div>`).join('')}
                            </div>
                            <div class="leave-bar absolute h-6 rounded border border-white/5 shadow-xl flex items-center px-3 cursor-help group transition-transform hover:scale-[1.01]"
                                 style="left: ${leftPos}%; width: ${widthPos}%; background: ${isConflicted ? 'linear-gradient(to right, #991b1b, #ef4444)' : 'linear-gradient(to right, #065f46, #10b981)'}">
                                <span class="text-[8px] font-black text-white truncate uppercase">${isConflicted ? '⚠️ COLLAPSE' : (emp.remark || 'PLANNED')}</span>
                                <div class="tooltip hidden absolute bottom-full left-1/2 -translate-x-1/2 mb-2 bg-slate-100 text-slate-900 text-[10px] font-bold p-2 rounded shadow-2xl z-50 whitespace-nowrap border-b-2 border-emerald-500">
                                    ${emp.name} (${emp.role})<br/>
                                    ${emp.start} TO ${emp.end}
                                </div>
                            </div>
                        </div>
                    `;
                    body.appendChild(row);
                }
            });

            confPanel.style.display = globalConflicts ? 'block' : 'none';
        }

        // Initial Launch
        renderDashboard();
    </script>
</body>
</html>

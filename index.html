<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conflict Alert: Leave Planner 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0b0f1a; color: #e2e8f0; font-family: 'Inter', sans-serif; }
        .gantt-container { display: grid; grid-template-columns: 280px 1fr; }
        .week-segment { flex: 1; border-right: 1px solid #33415544; font-size: 8px; text-align: center; padding-top: 4px; color: #64748b; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
    </style>
</head>
<body class="p-4">

    <div class="max-w-[1600px] mx-auto">
        <header class="flex flex-col xl:flex-row justify-between items-start xl:items-center mb-6 gap-4">
            <div>
                <h1 class="text-2xl font-bold text-emerald-400 tracking-tight">2026 ANNUAL LEAVE PLANNER</h1>
                <p class="text-slate-500 text-sm">Automated Conflict Detection Enabled</p>
            </div>

            <div class="flex flex-wrap gap-3 bg-slate-900/80 p-3 rounded-xl border border-slate-800">
                <input type="text" id="nameSearch" placeholder="Search name..." oninput="render()" 
                       class="bg-slate-800 border border-slate-700 rounded px-3 py-1.5 text-sm outline-none focus:border-emerald-500 w-40">
                
                <select id="teamFilter" onchange="render()" class="bg-slate-800 border border-slate-700 rounded px-3 py-1.5 text-sm outline-none">
                    <option value="All">All Teams</option>
                    <option value="Team B">Team B</option>
                    <option value="Team C">Team C</option>
                    <option value="Support Team">Support Team</option>
                    <option value="DC Team">DC Team</option>
                    <option value="Material Team">Material Team</option>
                </select>

                <div class="flex items-center gap-2 ml-4 text-xs font-bold text-slate-400 border-l border-slate-700 pl-4">
                    <span class="w-3 h-3 bg-emerald-500 rounded"></span> Clear
                    <span class="w-3 h-3 bg-red-500 rounded ml-2"></span> Conflict
                </div>
            </div>
        </header>

        <div id="conflictPanel" class="hidden mb-6 bg-red-950/30 border border-red-900/50 rounded-xl p-4">
            <h2 class="text-red-400 font-bold text-sm uppercase tracking-wider mb-3 flex items-center gap-2">
                ⚠️ Critical Team Overlaps Detected
            </h2>
            <div id="conflictList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                </div>
        </div>

        <div class="bg-slate-900 border border-slate-800 rounded-xl overflow-hidden shadow-2xl">
            <div class="gantt-container bg-slate-800/50 border-b border-slate-700">
                <div class="p-4 font-bold text-slate-300 border-r border-slate-700 uppercase text-[10px] tracking-widest flex items-end">Employee Details</div>
                <div class="flex flex-col">
                    <div class="flex border-b border-slate-700/50">
                        <script>
                            const m = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
                            m.forEach(name => document.write(`<div class="flex-1 text-center py-2 text-[10px] font-bold uppercase border-r border-slate-700/50 text-slate-500">${name}</div>`));
                        </script>
                    </div>
                    <div class="flex">
                        <script>
                            for(let i=0; i<12; i++) {
                                document.write('<div class="flex-1 flex border-r border-slate-700/30">');
                                for(let j=1; j<=4; j++) document.write(`<div class="week-segment">W${j}</div>`);
                                document.write('</div>');
                            }
                        </script>
                    </div>
                </div>
            </div>

            <div id="chartBody" class="max-h-[60vh] overflow-y-auto">
                </div>
        </div>
    </div>

    <script>
        const data = [
            { id: 1114, name: "Saurav cs", team: "Team C", role: "Piping Checker", start: "2026-04-15", end: "2026-05-15", remark: "MARRAIGE" },
            { id: 1329, name: "Vivek Krishnan", team: "Team B", role: "Piping Checker", start: "2026-05-24", end: "2026-06-24", remark: "" },
            { id: 2336, name: "Harikrishnan TS", team: "Team B", role: "Piping Checker", start: "2026-08-10", end: "2026-09-10", remark: "" },
            { id: 2277, name: "Mojahid Raja", team: "Team B", role: "Piping Checker", start: "2026-03-23", end: "2026-04-19", remark: "ANNUAL LEAVE" },
            { id: 1511, name: "Ritesh Kumar", team: "Team B", role: "Piping Checker", start: "2026-04-05", end: "2026-05-01", remark: "" },
            { id: 2412, name: "Mohammad Waquar", team: "Team B", role: "Piping Checker", start: "2026-10-15", end: "2026-11-15", remark: "" },
            { id: 2442, name: "Owaish Shamsi", team: "Team B", role: "Piping Checker", start: "2026-10-05", end: "2026-11-05", remark: "" },
            { id: 2154, name: "Salim Malick", team: "Team C", role: "Piping Detailer", start: "2026-04-12", end: "2026-05-25", remark: "Marriage" },
            { id: 2437, name: "Mohammad Navaz", team: "Team C", role: "Piping Detailer", start: "2026-07-26", end: "2026-08-28", remark: "" },
            { id: 2204, name: "Sabeel Manaf", team: "Team C", role: "Piping Checker", start: "2026-10-04", end: "2026-11-03", remark: "" },
            { id: 1183, name: "Mohammed Sadhik", team: "Team C", role: "Piping Checker", start: "2026-10-04", end: "2026-11-02", remark: "Annual" },
            { id: 2220, name: "Athul Vincent", team: "Support Team", role: "Support Checker", start: "2026-10-01", end: "2026-10-28", remark: "" },
            { id: 161, name: "Jayesh Saroj", team: "Support Team", role: "Team Leader", start: "2026-02-09", end: "2026-03-10", remark: "" },
            { id: 2477, name: "Prakyath Prakash", team: "DC Team", role: "Document Controller", start: "2026-09-01", end: "2026-10-01", remark: "" }
        ];

        function checkOverlaps(current, all) {
            return all.filter(other => {
                if (current.id === other.id) return false;
                if (current.team !== other.team || current.role !== other.role) return false;
                
                const s1 = new Date(current.start);
                const e1 = new Date(current.end);
                const s2 = new Date(other.start);
                const e2 = new Date(other.end);
                
                return s1 <= e2 && s2 <= e1;
            });
        }

        function render() {
            const team = document.getElementById('teamFilter').value;
            const search = document.getElementById('nameSearch').value.toLowerCase();
            const body = document.getElementById('chartBody');
            const confPanel = document.getElementById('conflictPanel');
            const confList = document.getElementById('conflictList');
            
            body.innerHTML = '';
            confList.innerHTML = '';
            let hasConflicts = false;

            data.forEach(emp => {
                const conflicts = checkOverlaps(emp, data);
                const isConflicting = conflicts.length > 0;
                
                if (isConflicting) {
                    hasConflicts = true;
                    const conflictText = `<div class="bg-red-900/20 border border-red-800/50 p-2 rounded text-[10px]">
                        <span class="text-red-400 font-bold">${emp.name}</span> clashes with 
                        <span class="text-red-300">${conflicts.map(c => c.name).join(', ')}</span> 
                        <br/><span class="text-slate-500">(${emp.team} - ${emp.role})</span>
                    </div>`;
                    if (!confList.innerHTML.includes(emp.name)) confList.innerHTML += conflictText;
                }

                if ((team === 'All' || emp.team === team) && emp.name.toLowerCase().includes(search)) {
                    const start = new Date(emp.start);
                    const end = new Date(emp.end);
                    const yearStart = new Date('2026-01-01');
                    const left = ((start - yearStart) / (1000 * 60 * 60 * 24) / 365) * 100;
                    const width = ((end - start) / (1000 * 60 * 60 * 24) / 365) * 100;

                    const row = document.createElement('div');
                    row.className = 'gantt-container border-b border-slate-800/50 hover:bg-slate-800/30';
                    row.innerHTML = `
                        <div class="p-3 border-r border-slate-800 bg-slate-900/50">
                            <div class="text-xs font-bold ${isConflicting ? 'text-red-400' : 'text-slate-200'}">${emp.name}</div>
                            <div class="text-[8px] text-slate-500 uppercase tracking-tighter">${emp.role}</div>
                        </div>
                        <div class="relative h-12 w-full flex items-center">
                            <div class="absolute inset-0 flex pointer-events-none">
                                ${Array(12).fill(0).map(() => `<div class="flex-1 border-r border-slate-800/30"></div>`).join('')}
                            </div>
                            <div class="absolute h-6 rounded flex items-center px-2 shadow-lg transition-all hover:scale-[1.01]"
                                 style="left: ${left}%; width: ${width}%; background: ${isConflicting ? 'linear-gradient(to right, #dc2626, #991b1b)' : 'linear-gradient(to right, #059669, #0d9488)'}">
                                <span class="text-[8px] font-black text-white truncate uppercase">${isConflicting ? '⚠️ CONFLICT' : (emp.remark || 'ON LEAVE')}</span>
                            </div>
                        </div>
                    `;
                    body.appendChild(row);
                }
            });

            confPanel.style.display = hasConflicts ? 'block' : 'none';
        }

        render();
    </script>
</body>
</html>
